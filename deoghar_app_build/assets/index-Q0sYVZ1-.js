import{j as e,u as se,i as te,a as re,g as ae,e as j,I as K,B as de,C as oe,_ as x}from"./index-DLJkMWUB.js";import{P as ne}from"./index-ChwPXrDZ.js";import{u as le,r as i,i as ie}from"./router-DWxcwEcu.js";import{u as ce,F as xe,c as me,e as he,a as f,o as ge}from"./switch-BXlVt4iJ.js";import{R as b}from"./RHFTextField-DfgCabiT.js";import{R as ue}from"./RHFTextArea-DTj_sxGC.js";import{r as je}from"./resizeImage-Cu6NmuKE.js";import{S as Q}from"./separator-DmTdbWr4.js";import{O as fe}from"./OverLayLoader-D7AAhvmj.js";import{R as be}from"./index-CNPgPTPc.js";import"./headlessui-DlCzxctq.js";import"./axios-BrYcoDUu.js";import"./module-BOQ-SnDo.js";const pe=({status:t})=>e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center ".concat(t==3||t==2||t==1?"text-white":"text-gray-400"),children:[e.jsx("div",{className:"rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ".concat(t==3||t==2||t==1?"bg-teal-600 border-teal-600":"border-gray-300"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-bookmark",children:e.jsx("path",{d:"M12 2v10m0 0v10m-7-10h14m-14 4h14m-14 4h14m-14 4h14M5 5v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z"})})}),e.jsx("div",{className:"absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ".concat(t==3||t==2||t==1?"text-teal-600":"text-gray-400"),children:"Tax Collector"})]}),e.jsx("div",{className:"flex-auto border-t-2 transition duration-500 ease-in-out ".concat(t==3||t==2||t==1?"border-teal-600":"border-gray-300")}),e.jsxs("div",{className:"flex items-center ".concat(t==3||t==2||t==1?"text-white":"text-gray-400"),children:[e.jsx("div",{className:"rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ".concat(t==3||t==2||t==1?"bg-teal-600 border-teal-600":"border-gray-300"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-user-check",children:e.jsx("path",{d:"M17 20h4v-4m-14 4h4v-4m0-6l7-5-7-5v10m-7-5h10"})})}),e.jsx("div",{className:"absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ".concat(t==3||t==2||t==1?"text-teal-600":"text-gray-400"),children:"Team Lead"})]}),e.jsx("div",{className:"flex-auto border-t-2 transition duration-500 ease-in-out ".concat(t==3||t==2||t==1?"border-teal-600":"border-gray-300")}),e.jsxs("div",{className:"flex items-center ".concat(t==2||t==1?"text-white":"text-gray-400"),children:[e.jsx("div",{className:"rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ".concat(t==2||t==1?"bg-teal-600 border-teal-600":"border-gray-300"),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-loader",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"18"}),e.jsx("line",{x1:"6",y1:"12",x2:"6",y2:"12"}),e.jsx("line",{x1:"18",y1:"12",x2:"18",y2:"12"})]})}),e.jsx("div",{className:"absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ".concat(t==2||t==1?"text-teal-600":"text-gray-400"),children:"In progress"})]}),e.jsx("div",{className:"flex-auto border-t-2 transition duration-500 ease-in-out ".concat(t==1?"border-teal-600":"border-gray-300")}),e.jsxs("div",{className:"flex items-center ".concat(t==1?"text-white":"text-gray-400"),children:[e.jsx("div",{className:"rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ".concat(t===1?"bg-teal-600 border-teal-600":"border-gray-300"),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-check-circle",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),e.jsx("div",{className:"absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ".concat(t==1?"text-teal-600":"text-gray-400"),children:"Resolved"})]})]})})}),ye=me().shape({photo:he().required("Photo is required").nullable(),latitude:f(),longitude:f(),remarks:f()});function Ae(){var N,v,k,w,L,S,R,$,I,F,_,P,T,A,B,O,V,M,U,W,E,H,q,z;const t=le(),[m,p]=i.useState(""),[X,Y]=i.useState(""),[Z,y]=i.useState(0),[C,h]=i.useState(!1),g=se({}),{coords:n}=te(),{user:u}=re(),{id:c}=ie(),s=ae({api:j.getComplainDetails,config:{id:c},options:{enabled:!!c}}),l=ce({resolver:ge(ye),defaultValues:{photo:null,latitude:"",longitude:"",remarks:""}});i.useEffect(()=>{var a,r,o,d,G,J;(r=(a=s==null?void 0:s.data)==null?void 0:a.data)!=null&&r.tc_photo&&(p((d=(o=s==null?void 0:s.data)==null?void 0:o.data)==null?void 0:d.tc_photo),Y((J=(G=s==null?void 0:s.data)==null?void 0:G.data)==null?void 0:J.tl_photo))},[(N=s==null?void 0:s.data)==null?void 0:N.data]);const D=async a=>{oe("Are you sure?","Please confirm",async()=>{try{const r=new FormData;r.append("photo",a.photo),r.append("latitude",String(a.latitude)),r.append("longitude",String(a.longitude)),r.append("id",String(c)),r.append("remarks",String(a.remarks));const o=await g.mutateAsync({api:j.switchStatus,data:{id:c}});if(o.data.status){const d=await g.mutateAsync({api:j.complainResolved,data:r});d.data.status?(x.success(d.data.msg),t("/deoghar-app/view-complain-list")):x.error(d.data.msg)}else x.error(o.data.msg)}catch(r){x.error(r.msg)}})},ee=async a=>{const r=a.target.files[0];if(!r)return;const o=await je(r),d=new File([o],r==null?void 0:r.name,{type:"image/*"});l.setValue("photo",d),l.setValue("latitude",String(n==null?void 0:n.latitude)),l.setValue("longitude",String(n==null?void 0:n.longitude)),p(URL.createObjectURL(d)||URL.createObjectURL(r))};return e.jsxs(ne,{title:"Complain Details",children:[g.isLoading&&e.jsx(fe,{}),e.jsx(be,{index:Z,slides:[{src:m,title:"Geo Tagging Image"},{src:X,title:"Complain Resolved Image"}],open:C,close:()=>h(!1)}),e.jsx("main",{className:"p-4",children:s!=null&&s.isFetching?e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm",children:e.jsx("div",{className:"animate-pulse flex space-x-4",children:e.jsxs("div",{className:"flex-1 space-y-4 py-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]})]})})}):e.jsx("div",{children:s.status==="success"?e.jsxs(e.Fragment,{children:[e.jsx(pe,{status:(k=(v=s==null?void 0:s.data)==null?void 0:v.data)==null?void 0:k.status}),e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1 justify-center items-center",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"Consumer Name:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500 w-30 truncate",children:(L=(w=s==null?void 0:s.data)==null?void 0:w.data)==null?void 0:L.consumer_name}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"Complain No:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:(R=(S=s==null?void 0:s.data)==null?void 0:S.data)==null?void 0:R.complain_no}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"Consumer No:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:(I=($=s==null?void 0:s.data)==null?void 0:$.data)==null?void 0:I.consumer_no}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"Address:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:(_=(F=s==null?void 0:s.data)==null?void 0:F.data)==null?void 0:_.address}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"Complain:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:(T=(P=s==null?void 0:s.data)==null?void 0:P.data)==null?void 0:T.complain}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"TC Name:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:(B=(A=s==null?void 0:s.data)==null?void 0:A.data)==null?void 0:B.tcName}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:"TC Remarks:"}),e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:(V=(O=s==null?void 0:s.data)==null?void 0:O.data)==null?void 0:V.tc_remarks})]})}),e.jsx(Q,{className:"mt-4 mb-4"}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[((U=(M=s==null?void 0:s.data)==null?void 0:M.data)==null?void 0:U.tl_photo)!=""&&e.jsxs("div",{className:"flex-col",children:[e.jsx(K,{onClick:()=>{h(!0),y(1)},src:(E=(W=s==null?void 0:s.data)==null?void 0:W.data)==null?void 0:E.tl_photo,className:"rounded-lg shadow-lg h-40 w-40 "}),e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Complain Resolved Image"})]}),e.jsx("div",{className:"flex justify-center col-span-2",children:m!=""&&e.jsxs("div",{className:"flex-col",children:[e.jsx(K,{onClick:()=>{h(!0),y(0)},src:m,className:"rounded-lg shadow-lg h-40 w-40 "}),e.jsx("span",{className:"text-xs font-semibold text-gray-500",children:"Complain Raised Image"})]})})]}),e.jsx(Q,{className:"mt-4 mb-4"}),(u==null?void 0:u.userTypeId)==4&&((q=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:q.status)!=1&&e.jsxs(xe,{methods:l,onSubmit:l.handleSubmit(D),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(b,{type:"file",onChange:a=>{ee(a)},label:"Upload Photo"})}),e.jsx("div",{children:e.jsx(b,{name:"latitude",label:"Latitude",className:"w-full",disabled:!0})}),e.jsx("div",{children:e.jsx(b,{name:"longitude",label:"Longitude",className:"w-full",disabled:!0})}),e.jsx("div",{className:"col-span-2",children:e.jsx(ue,{name:"remarks",label:"Remarks",className:"border border-gray-200 rounded-lg p-2 w-full"})})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(de,{type:"submit",variant:"default",children:"Submit"})})]})]}):e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm mt-4",children:e.jsx("div",{className:"text-center text-red-500",children:(z=s.data)==null?void 0:z.msg})})})})]})}export{Ae as default};
